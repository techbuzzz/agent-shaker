<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Task Tracker</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ MCP Task Tracker</h1>
            <p>AI Agent Task Coordination System</p>
            <span class="status online" id="wsStatus">‚óè Connected</span>
        </header>

        <div class="tabs">
            <button class="tab active" data-tab="projects">Projects</button>
            <button class="tab" data-tab="agents">Agents</button>
            <button class="tab" data-tab="tasks">Tasks</button>
            <button class="tab" data-tab="contexts">Documentation</button>
        </div>

        <div id="projects" class="tab-content active">
            <div style="margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="openProjectModal()">+ New Project</button>
            </div>
            <div id="projectsList" class="grid"></div>
        </div>

        <div id="agents" class="tab-content">
            <div style="margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="openAgentModal()">+ Register Agent</button>
            </div>
            <div id="agentsList" class="grid"></div>
        </div>

        <div id="tasks" class="tab-content">
            <div style="margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="openTaskModal()">+ Create Task</button>
            </div>
            <div id="tasksList" class="grid"></div>
        </div>

        <div id="contexts" class="tab-content">
            <div class="tab-header">
                <div class="tab-actions">
                    <button class="btn btn-primary" onclick="openContextModal()">
                        <span class="btn-icon">‚ûï</span>
                        Add Documentation
                    </button>
                </div>
                <div class="tab-filters">
                    <div class="search-box">
                        <input type="text" id="contextSearch" placeholder="Search documentation..." onkeyup="filterContexts()">
                        <span class="search-icon">üîç</span>
                    </div>
                    <div class="filter-tags">
                        <select id="tagFilter" onchange="filterContexts()">
                            <option value="">All Tags</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="loading-spinner" id="contextsLoading" style="display: none;">
                <div class="spinner"></div>
                <p>Loading documentation...</p>
            </div>
            <div id="contextsList" class="grid"></div>
        </div>
    </div>

    <!-- Modals -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create New Project</h2>
                <span class="close" onclick="closeModal('projectModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form onsubmit="createProject(event)">
                    <div class="form-group">
                        <label>Project Name</label>
                        <input type="text" id="projectName" placeholder="Enter project name" required>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="projectDescription" placeholder="Enter project description"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('projectModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Create Project</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="agentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add Agent to Project</h2>
                <span class="close" onclick="closeModal('agentModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form onsubmit="createAgent(event)">
                    <div class="form-group">
                        <label>Agent Name</label>
                        <input type="text" id="agentName" required>
                    </div>
                    <div class="form-group">
                        <label>Role</label>
                        <select id="agentRole" required>
                            <option value="Frontend">Frontend</option>
                            <option value="Backend">Backend</option>
                            <option value="DevOps">DevOps</option>
                            <option value="QA">QA</option>
                            <option value="Design">Design</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Team</label>
                        <input type="text" id="agentTeam" placeholder="Enter team name">
                    </div>
                    <div style="display: none;">
                        <select id="agentProjectId" required></select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('agentModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Add Agent</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="taskModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create Task</h2>
                <span class="close" onclick="closeModal('taskModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form onsubmit="createTask(event)">
                    <div class="form-group">
                        <label>Project</label>
                        <select id="taskProjectId" required onchange="loadAgentsForTask()"></select>
                    </div>
                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="taskTitle" placeholder="Enter task title" required>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="taskDescription" placeholder="Enter task description"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Priority</label>
                        <select id="taskPriority">
                            <option value="low">Low</option>
                            <option value="medium" selected>Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Created By (Agent)</label>
                        <select id="taskCreatedBy" required></select>
                    </div>
                    <div class="form-group">
                        <label>Assigned To (Agent)</label>
                        <select id="taskAssignedTo">
                            <option value="">Unassigned</option>
                        </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('taskModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Create Task</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="contextModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add Documentation</h2>
                <span class="close" onclick="closeModal('contextModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form onsubmit="createContext(event)">
                    <div class="form-group">
                        <label>Project</label>
                        <select id="contextProjectId" required onchange="loadAgentsAndTasksForContext()"></select>
                    </div>
                    <div class="form-group">
                        <label>Agent</label>
                        <select id="contextAgentId" required></select>
                    </div>
                    <div class="form-group">
                        <label>Related Task (Optional)</label>
                        <select id="contextTaskId">
                            <option value="">None</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="contextTitle" placeholder="Enter documentation title" required>
                    </div>
                    <div class="form-group">
                        <label>Content (Markdown)</label>
                        <textarea id="contextContent" placeholder="Enter markdown content" style="min-height: 200px;"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Tags (comma-separated)</label>
                        <input type="text" id="contextTags" placeholder="api, documentation, backend">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('contextModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Add Documentation</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="modal">
        <div class="confirmation-modal">
            <div class="modal-title">‚ö†Ô∏è Confirm Action</div>
            <div class="modal-body" id="confirmationMessage">Are you sure you want to proceed?</div>
            <div class="confirmation-actions">
                <button class="btn btn-secondary" onclick="closeModal('confirmationModal')">Cancel</button>
                <button class="btn btn-danger" id="confirmActionBtn">Confirm</button>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <script src="/app.js"></script>
</body>
</html>
